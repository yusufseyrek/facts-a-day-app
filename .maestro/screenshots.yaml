# Main Screenshot Orchestration Flow
# Runs all screen flows in sequence to capture promotional screenshots
#
# IMPORTANT: Use the screenshots.sh script for proper folder structure!
#   ./scripts/screenshots.sh --ios --locale en
#
# The OUTPUT_DIR env var MUST be passed via -e flag

appId: dev.seyrek.factsaday

---
# Launch the app with locale override
# arguments are passed as -key value to the app process on iOS
- launchApp:
    clearState: false
    clearKeychain: false
    arguments:
      AppleLanguages: "(${LOCALE})"
      AppleLocale: "${FULL_LOCALE}"

# Wait for app to fully load (tab bar visible)
- extendedWaitUntil:
    visible:
      id: "tab-home"
    timeout: 15000

# Wait for initial content to load (facts should appear)
- extendedWaitUntil:
    visible:
      id: "fact-card-.*"
    timeout: 15000

# Extended wait for all animations, image loading, and list settling
# This prevents kAXErrorInvalidUIElement errors from FlashList recycling
- waitForAnimationToEnd:
    timeout: 4000

# Run all screen flows in sequence
# Flows assume state from previous flow for efficiency

# 1. Home Screen (already on home after launch)
- runFlow: flows/home.yaml

# 2. Fact Detail (opens modal from home)
- runFlow: flows/fact-detail.yaml

# 3. Story Screen (opens story from home)
- runFlow: flows/story.yaml

# 4. Discover Screen (navigates to discover tab)
- runFlow: flows/discover.yaml

# 5. Category Browse (taps category, already on discover)
- runFlow: flows/category-browse.yaml

# 6. Trivia Hub (navigates to trivia tab)
- runFlow: flows/trivia.yaml

# 7. Trivia Game (starts game, already on trivia hub)
- runFlow: flows/trivia-game.yaml

# 8. Trivia Performance (opens from trivia hub)
- runFlow: flows/trivia-performance.yaml

# 9. Trivia Results (taps session, already on performance)
- runFlow: flows/trivia-results.yaml

# 10. Favorites Screen (navigates to favorites tab)
- runFlow: flows/favorites.yaml

# Return to home
- tapOn:
    id: "tab-home"
